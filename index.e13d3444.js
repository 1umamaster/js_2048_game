const t=new class{constructor(t){this.board=t||[,,,,].fill().map(()=>[,,,,].fill(0)),this.score=0,this.status="idle"}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}start(){this.board=[,,,,].fill().map(()=>[,,,,].fill(0)),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.start()}moveLeft(){let t=!1;this.board=this.board.map(e=>{let s=e.filter(t=>0!==t);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,this.score+=s[e],s[e+1]=0,t=!0);let a=s.filter(t=>0!==t);for(;a.length<4;)a.push(0);return t||e.toString()===a.toString()||(t=!0),a}),t&&this.addRandomTile(),this.checkGameState()}moveRight(){this.board=this.board.map(t=>t.reverse()),this.moveLeft(),this.board=this.board.map(t=>t.reverse())}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}addRandomTile(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,a)=>{0===e&&t.push({i:s,j:a})})}),t.length>0){let{i:e,j:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}checkGameState(){if(this.board.flat().includes(2048)){this.status="win";return}this.board.some((t,e)=>t.some((t,s)=>0===t||s<3&&t===this.board[e][s+1]||e<3&&t===this.board[e+1][s]))||(this.status="lose")}transpose(){this.board=this.board[0].map((t,e)=>this.board.map(t=>t[e]))}},e=document.querySelectorAll(".field-cell"),s=document.querySelector(".game-score"),a=document.querySelector(".button.start"),r={start:document.querySelector(".message-start"),win:document.querySelector(".message-win"),lose:document.querySelector(".message-lose")};function o(){let o=t.getState();e.forEach((t,e)=>{let s=o[Math.floor(e/4)][e%4];t.className="field-cell",s>0&&t.classList.add(`field-cell--${s}`),t.textContent=s||""}),s.textContent=t.getScore(),Object.keys(r).forEach(t=>{r[t].classList.add("hidden")}),"idle"===t.getStatus()?r.start.classList.remove("hidden"):"win"===t.getStatus()?r.win.classList.remove("hidden"):"lose"===t.getStatus()&&r.lose.classList.remove("hidden"),"playing"===t.getStatus()||"lose"===t.getStatus()?a.textContent="Restart":a.textContent="Start",a.classList.add("restart")}a.addEventListener("click",()=>{t.restart(),o()}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}o()}});
//# sourceMappingURL=index.e13d3444.js.map
